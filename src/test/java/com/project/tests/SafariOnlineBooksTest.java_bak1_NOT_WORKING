package com.selenium.tests;

import org.testng.Assert;
import org.testng.annotations.DataProvider;
import org.testng.annotations.Test;
import org.testng.annotations.BeforeClass;

import com.selenium.pages.SafariBooksOnlinePage;

import java.io.FileReader;
import java.util.Iterator;

import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;


public class SafariOnlineBooksTest {
	
	final static String SHARED_TEST_DATA_FILE = "src/test/resources/testdata.json";
	
	JSONParser parser = new JSONParser();

	 
    try {

        Object obj = parser.parse(new FileReader(
                "/Users/<username>/Documents/file1.txt"));

        JSONObject jsonObject = (JSONObject) obj;

        String name = (String) jsonObject.get("Name");
        String author = (String) jsonObject.get("Author");
        JSONArray companyList = (JSONArray) jsonObject.get("Company List");

        System.out.println("Name: " + name);
        System.out.println("Author: " + author);
        System.out.println("\nCompany List:");
        Iterator<String> iterator = companyList.iterator();
        while (iterator.hasNext()) {
            System.out.println(iterator.next());
        }

    } catch (Exception e) {
        e.printStackTrace();
    }
	
	
	@DataProvider
	public Object[][] searchData() {
		return new Object[][] {
			new Object[] {"Selenium", "842"},
			new Object[] {"Ruby", "4405"}
		};	
	}

	@Test(dataProvider = "searchData")
	public void testSafariOnlineBooks(String searchString, String numberOfResults) {
		SafariBooksOnlinePage safariSearch = new SafariBooksOnlinePage();
		safariSearch.load();
		safariSearch.searchForText(searchString);

		Assert.assertEquals("Search for : Safari", safariSearch.getTitle());
		Assert.assertTrue(safariSearch.pageContainsText(numberOfResults));
		safariSearch.close();
	}

}

